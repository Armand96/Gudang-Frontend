<ion-content scroll-y='true'>

  <div class="container-fluid" class="m-3">

    <div class="row" *ngIf="data">
      <div class="col p-1 ml-1 mr-1" id="print_div">

        <div class="table-responsive"  #print_div>
          <table id="mytable" class="table table-borderless mb-0">
            <thead>
              <tr>
                <th colspan="2" rowspan="4" class="text-center border-left border-top border-bottom border-dark"> <img
                    src="../../../../../assets/img/Logo-DKB.png" alt="" width="200px" height="100px"> </th>
                <th colspan="7" rowspan="4" class="border-right border-top border-bottom border-dark">
                  <h4 class="text-center"> PT. DOK & PERKAPALAN KODJA BAHARI <br> (PERSERO) <br> SHIPYARD JAKARTA-II
                  </h4>
                </th>
                <th style="vertical-align: middle" class="p-0 pl-2 border-top border-dark"> Nomor </th>
                <th style="vertical-align: middle; width: 1%" class="p-0 border-right border-top border-dark">: FF15GD2-A3.03 </th>
              </tr>
              <tr>
                <th style="vertical-align: middle" class="p-0 pl-2"> Revisi </th>
                <th style="vertical-align: middle; width: 1%" class="p-0 border-right border-dark">: 0 </th>
              </tr>
              <tr>
                <th style="vertical-align: middle" class="p-0 pl-2"> Tanggal </th>
                <th style="vertical-align: middle; width: 1%" class="p-0 border-right border-dark">: 15/06/2010 </th>
              </tr>
              <tr>
                <th style="vertical-align: middle" class="p-0 pl-2"> Halaman</th>
                <th style="vertical-align: middle; width: 1%" class="p-0 border-right border-bottom border-dark">: 01 dari 01 </th>
              </tr>

              <tr>
                <th colspan="11" class="text-center border p-1 border-dark">FORMAT</th>
              </tr>

              <tr>
                <th colspan="11" class="text-center p-1"> SURAT PERMINTAAN MATERIAL </th>
              </tr>

              <tr>
                <th colspan="11" class="text-center p-1 pl-3"> SPM NO. {{data.arraydata[0].no_spm}}</th>
              </tr>

              <tr>
                <th class="p-0" colspan="2"> Proyek </th>
                <!-- <th class="p-0" *ngIf="data.proyek"> : {{data.proyek}} </th> -->
                <th class="p-0" *ngIf="data.arraydata[0].proyek" colspan="2"> : {{data.arraydata[0].proyek}} </th>
              </tr>

              <tr>
                <th class="p-0" colspan="2"> No. Order </th>
                <th class="p-0" colspan="2"> : {{data.arraydata[0].no_order}} </th>
                <th class="p-0" colspan="2"> Pekerjaan </th>
                <th class="p-0" colspan="2"> : {{data.arraydata[0].pekerjaan}} </th>
              </tr>

              <tr>
                <th  class="p-0" colspan="2"> Bid / Bkl </th>
                <th class="p-0" colspan="2"> : {{data.arraydata[0].bengkel}} </th>
                <th  class="p-0" colspan="2"> Kode Pekerjaan </th>
                <th class="p-0" colspan="2"> : {{data.arraydata[0].kode_pekerjaan}} </th>
              </tr>

              <tr>
                <th style="vertical-align: middle; width: 2%" rowspan="2" class="text-center border border-dark P-0"> NO. </th>
                <th style="vertical-align: middle; width: 8%" rowspan="2" class="text-center border border-dark P-0"> KODE </th>
                <th style="vertical-align: middle" rowspan="2" colspan="2" class="text-center border border-dark P-0"> NAMA &
                  SPESIFIKASI BARANG </th>
                <th style="vertical-align: middle; width: 3%" rowspan="2" class="text-center border border-dark P-0"> SATUAN </th>
                <th style="vertical-align: middle" colspan="2" class="text-center border border-dark P-0"> JUMLAH DIMINTA</th>
                <th style="vertical-align: middle" colspan="2" class="text-center border border-dark P-0"> JUMLAH DISERAHKAN</th>
                <th style="vertical-align: middle; width: 1%" rowspan="2" class="text-center border border-dark P-0"> HARGA SATUAN</th>
                <th style="vertical-align: middle; width: 1%" rowspan="2" class="text-center border border-dark P-0"> JUMLAH HARGA </th>
              </tr>

              <tr>
                <th style="vertical-align: middle; width: 10%" class="text-center border p-0 border-dark">ANGKA</th>
                <th style="vertical-align: middle; width: 10%" class="text-center border p-0 border-dark">HURUF</th>
                <th style="vertical-align: middle; width: 10%" class="text-center border p-0 border-dark">ANGKA</th>
                <th style="vertical-align: middle; width: 10%" class="text-center border p-0 border-dark">HURUF</th>
              </tr>
            </thead>
            <tbody>
              <tr *ngFor="let item of data.arraydata | paginate: { itemsPerPage: 20, currentPage: p }; ">
                <td style="vertical-align: middle; width: 2%" class="text-center border-left border-right p-0 border-dark">{{item.indexx}}</td>
                <td style="vertical-align: middle; width: 8%" class="text-center border-left border-right p-0 border-dark">
                  {{item.nomor_barang}}</td>
                <td style="vertical-align: middle" class="border-left border-right p-0 pl-2 border-dark" colspan="2">{{item.nama_barang}}
                </td>
                <td style="vertical-align: middle; width: 3%" class="text-center border-left border-right p-0 border-dark">{{item.satuan}}</td>
                <td style="vertical-align: middle" class="text-center border-left border-right p-0 border-dark">
                  {{item.jml_klr_angka}}</td>
                <td style="vertical-align: middle" class="text-center border-left border-right p-0 border-dark">
                  {{item.jml_klr_huruf}}</td>
                <td style="vertical-align: middle" class="text-center border-left border-right p-0 border-dark">
                  {{item.jml_klr_permintaan_angka}}</td>
                <td style="vertical-align: middle" class="text-center border-left border-right p-0 border-dark">
                  {{item.jml_klr_permintaan_huruf}}</td>
                <td style="vertical-align: middle; width: 1%" class="text-center border-left border-right p-0 border-dark">
                </td>
                <td style="vertical-align: middle; width: 1%" class="text-center border-left border-right p-0 border-dark">
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr>
                <td colspan="6" class="text-center p-0 border-top border-bottom border-left border-dark">Paraf</td>
                <td colspan="5" class="text-center p-0 border-top border-bottom border-right border-dark">Tanda Tangan & Nama Jelas</td>
              </tr>
              <tr>
                <td colspan="2" class="text-center">Menyetujui</td>
                <td colspan="2" class="text-center">Renwas</td>
                <td colspan="2" class="text-center">Gudang</td>
                <td colspan="2" class="text-center">Peminta</td>
                <td colspan="2" class="text-center">Penerima</td>
                <td class="text-center">Pemberi</td>
              </tr>
              <tr>
                <td colspan="11" class="p-0"> &nbsp; </td>
              </tr>
              <tr>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.man != ''"> <u>{{func.brgKeluarInfo.man}}</u> </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.renwas != ''"> <u>{{func.brgKeluarInfo.renwas}}</u> </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.kabid != ''"> <u>{{func.brgKeluarInfo.kabid}}</u> </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.kabeng != ''"> <u>{{func.brgKeluarInfo.kabeng}}</u> </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.penerima != ''"> <u>{{func.brgKeluarInfo.penerima}}</u> </td>
                <td class="text-center p-0" *ngIf="func.brgKeluarInfo.pemberi != ''"> <u>{{func.brgKeluarInfo.pemberi}}</u> </td>
                <!-- if the data is '' -->
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.man == ''"> ________________ </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.renwas == ''"> ________________ </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.kabid == ''"> ________________ </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.kabeng == ''"> ________________ </td>
                <td colspan="2" class="text-center p-0" *ngIf="func.brgKeluarInfo.penerima == ''"> ________________ </td>
                <td class="text-center p-0" *ngIf="func.brgKeluarInfo.pemberi == ''"> ________________ </td>
              </tr>

              <tr>
                <td colspan="2" class="text-center p-0">Man/Asman</td>
                <td colspan="2" class="text-center p-0">Asman/Renwas</td>
                <td colspan="2" class="text-center p-0">Kabid.Gudang</td>
                <td colspan="2" class="text-center p-0">Kabid/Kabeng</td>
                <td colspan="2" class="text-center p-0">....................</td>
                <!-- <td class="text-center">Pemberi</td> -->
              </tr>

              <tr>
                <td colspan="3" class="p-0">Catatan: Harga diisi oleh Akuntansi</td>
              </tr>
              <tr>
                <td colspan="3" class="p-0">Lembar 1 Keuangan</td>
              </tr>
              <tr>
                <td colspan="3" class="p-0">Lembar 2 Produksi</td>
              </tr>
              <tr>
                <td colspan="3" class="p-0">Lembar 3 Peminta</td>
              </tr>
              <tr>
                <td colspan="3" class="p-0">Lembar 4 Renwas</td>
              </tr>
              <tr>
                <td colspan="3" class="p-0">Lembar 5 Arsip</td>
              </tr>
            </tfoot>
          </table>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col text-center">
        <pagination-controls (pageChange)="p = $event"></pagination-controls>
      </div>
    </div>

    <div class="row">
      <div class="col text-center text-sm-left">
        <button class="btn btn-light" style="border-radius: 20px"
          styleSheetFile="../../../../../assets/css/bootstrap.min.css"
          printSectionId="print_div"
          ngxPrint> 
          <ion-button shape="round" color="warning">
            <ion-icon slot="start" name="save" color="dark"></ion-icon>
            <ion-text color="dark"> <b>Cetak</b>  </ion-text> 
          </ion-button>  
        </button>
        <!-- <ion-button shape="round" color="warning" (click)="print()">
          <ion-icon slot="start" name="save" color="dark"></ion-icon>
           <ion-text color="dark"> <b>Simpan ke PDF</b>  </ion-text> 
        </ion-button> -->
      </div>
    </div>

    <div class="row">
      <div class="col text-center text-sm-left">
        <ion-button shape="round" color="warning" (click)="onClick()">
          <ion-icon slot="start" name="print" color="dark"></ion-icon>
          <ion-text color="dark">  <b>Simpan ke Excel</b>   </ion-text> 
        </ion-button>
      </div>
    </div>

  </div>

</ion-content>